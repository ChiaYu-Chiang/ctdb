{% load i18n custom_templatetags %}

<nav class="navbar mb-n-navbar navbar-expand-xl navbar-light bg-white fixed-top scroll-sensitive">
  <div class="container-fluid" style="max-width: 1440px;">
    <a class="navbar-brand nav-link" href="{% url 'index' %}">
      {% include 'brand_thumbnail.html' %}
    </a>
    <a class="navbar-brand nav-link mr-auto" href="{% url 'index' %}" style="margin-left: -2.75rem;">
      <span class="text-secondary" style="font-size: 1.45rem;">{% translate 'TDB' %}</span>
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#togglerTarget"
      aria-controls="togglerTarget" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="togglerTarget">
      <ul class="navbar-nav mr-auto" style="padding-left: 3.55rem;">
        {% if user.is_authenticated %}
        <a class="nav-item nav-link" href="{% url 'news:news_list' %}">
          {% translate 'News' %}
        </a>
        {% endif %}
        {% if perms.diary.view_diary or perms.diary.add_diary %}
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="true">
            {% translate 'Diary' %}
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            {% if perms.diary.view_diary %}
            <a class="dropdown-item" href="{% url 'diary:diary_list' %}">{% translate 'Diary' %} | {% translate 'List' %}</a>
            {% endif %}
            {% if perms.diary.add_diary %}
            <a class="dropdown-item" href="{% url 'diary:diary_create' %}">{% translate 'Diary' %} | {% translate 'Add' %}</a>
            {% endif %}
          </div>
          {% endif %}
        </li>
        <li class="nav-item dropdown">
          {% if perms.reminder.view_reminder or perms.reminder.add_reminder %}
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="true">
            {% translate 'Reminder' %}
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            {% if perms.reminder.view_reminder %}
            <a class="dropdown-item" href="{% url 'reminder:reminder_list' %}">{% translate 'Reminder' %} |
              {% translate 'List' %}</a>
            {% endif %}
            {% if perms.reminder.add_reminder %}
            <a class="dropdown-item" href="{% url 'reminder:reminder_create' %}">{% translate 'Reminder' %} |
              {% translate 'Add' %}</a>
            {% endif %}
          </div>
          {% endif %}
        </li>
        <li class="nav-item dropdown">
          {% if perms.telecom.view_isp or perms.telecom.add_isp or perms.telecom.view_ispgroup or perms.telecom.add_ispgroup or perms.telecom.view_prefixlistupdatetask or perms.telecom.add_prefixlistupdatetask %}
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="true">
            {% translate 'Telecom' %}
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            {% if perms.telecom.view_isp %}
            <a class="dropdown-item" href="{% url 'telecom:isp_list' %}">{% translate 'ISP' %} | {% translate 'List' %}</a>
            {% endif %}
            {% if perms.telecom.add_isp %}
            <a class="dropdown-item" href="{% url 'telecom:isp_create' %}">{% translate 'ISP' %} | {% translate 'Add' %}</a>
            {% endif %}
            {% if perms.telecom.view_ispgroup %}
            <a class="dropdown-item" href="{% url 'telecom:ispgroup_list' %}">{% translate 'ISP group' %} |
              {% translate 'List' %}</a>
            {% endif %}
            {% if perms.telecom.add_ispgroup %}
            <a class="dropdown-item" href="{% url 'telecom:ispgroup_create' %}">{% translate 'ISP group' %} |
              {% translate 'Add' %}</a>
            {% endif %}
            {% if perms.telecom.view_prefixlistupdatetask %}
            <a class="dropdown-item"
              href="{% url 'telecom:prefixlistupdatetask_list' %}">{% translate 'Prefix-list update task' %} |
              {% translate 'List' %}</a>
            {% endif %}
            {% if perms.telecom.add_prefixlistupdatetask %}
            <a class="dropdown-item"
              href="{% url 'telecom:prefixlistupdatetask_create' %}">{% translate 'Prefix-list update task' %} |
              {% translate 'Add' %}</a>
            {% endif %}
          </div>
          {% endif %}
        </li>
        <li class="nav-item dropdown">
          {% if perms.archive.view_archive or perms.archive.add_archive %}
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="true">
            {% translate 'Archive' %}
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            {% if perms.archive.view_archive %}
            <a class="dropdown-item" href="{% url 'archive:archive_list' %}">{% translate 'Archive' %} | {% translate 'List' %}</a>
            {% endif %}
            {% if perms.archive.add_archive %}
            <a class="dropdown-item" href="{% url 'archive:archive_create' %}">{% translate 'Archive' %} | {% translate 'Add' %}</a>
            {% endif %}
            {% if perms.archive.view_archive %}
            <a class="dropdown-item" href="{% url 'archive:journals_list' %}">{% translate 'Archive' %} | {% translate 'journals List' %}</a>
            {% endif %}
            {% if perms.archive.add_archive %}
            <a class="dropdown-item" href="{% url 'archive:journals_create' %}">{% translate 'Archive' %} | {% translate 'journals Add' %}</a>
            {% endif %}
          </div>
          {% endif %}
        </li>
        <li class="nav-item dropdown">
          {% if perms.log.view_log %}
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="true">
            {% translate 'Log' %}
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            {% if perms.log.view_log %}
            <a class="dropdown-item" href="{% url 'log:diary_log_list' %}">{% translate 'Log' %} | {% translate 'Diary' %} |
              {% translate 'List' %}</a>
            {% endif %}
          </div>
          {% endif %}
        </li>
      </ul>
      <ul class="navbar-nav ml-auto" style="padding-left: 3.55rem;">
        {% if user.is_authenticated %}
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
            {{ user.username }}
          </a>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="{% url 'accounts:logout' %}">{% translate 'Logout' %}</a>
            <a class="dropdown-item" href="{% url 'accounts:profile_change' %}">{% translate 'Profile' %}</a>
            <a class="dropdown-item" href="{% url 'accounts:password_change' %}">{% translate 'Password change' %}</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="{% url 'accounts:password_reset' %}">{% translate 'Password reset' %}</a>
          </div>
        </li>
        <li class="nav-item dropdown">
          {% role_list user as roles %}
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
            {% translate user.profile.activated_role.name|default:'------' %}
          </a>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
            {% for role in roles %}
            <a class="dropdown-item" href="{% url 'accounts:role_change' pk=role.pk %}">{% translate role.name %}</a>
            {% empty %}
            <a class="dropdown-item" href="">{% translate 'No available roles' %}</a>
            {% endfor %}
          </div>
        </li>
        {% else %}
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="true">
            {% translate "Guest" %}
          </a>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="{% url 'accounts:login' %}">{% translate 'Login' %}</a>
            <a class="dropdown-item" href="{% url 'accounts:signup' %}">{% translate 'Sign up' %}</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="{% url 'accounts:password_reset' %}">{% translate 'Password reset' %}</a>
          </div>
        </li>
        {% endif %}
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" id="navbarDropdown" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="true">
            {{ LANGUAGE_CODE }}
          </a>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
            {% for language in languages %}
            <a class="dropdown-item set-language-item cursor-pointer">{{ language.code }}</a>
            {% endfor %}
          </div>
        </li>
      </ul>
    </div>
  </div>
</nav>